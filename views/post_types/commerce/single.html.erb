<%= content_for :script do %>
    <%= javascript_include_tag theme_asset_path('js/product_manifest') %>
<% end %>
<div class="products-page" id="product_view">
    <%= render 'post_types/commerce/product_sidebar', product: @post %>
    <div class="new-product">
        <div class="col-md-5 zoom-grid">
            <div class="flexslider">
                <ul class="slides">
                    <% @post.get_fields('ecommerce_photos').each do |img| %>
                        <li data-thumb="<%= img.cama_parse_image_version %>">
                            <div class="thumb-image"> <img src="<%= img %>" data-imagezoom="true" class="img-responsive" alt="" /> </div>
                        </li>
                    <% end %>
                </ul>
            </div>
        </div>
        <div class="col-md-7 dress-info">
            <div class="dress-name">
                <h3><%= @post.the_title %></h3>
                <span id="product_price"><%= raw @post.the_price %></span>
                <div class="clearfix"></div>
                <div><strong>SKU: </strong><b id="product_sku"><%= @post.the_sku %></b></div>
                <%= raw @post.the_excerpt %>
                <%= @post.the_edit_link %>
            </div>
            <% @post.the_attribute_fields('ecommerce_attrs').each_with_index do |attr, index| %>
                <div class="span span<%= index != 1 ? 1 : 2 %>">
                    <p class="left"><%= attr['attr'].to_s.translate.upcase %></p>
                    <p class="right"><%= attr['value'].to_s.translate %></p>
                    <div class="clearfix"></div>
                </div>
            <% end %>
            <div class="purchase">
                <% if @post.in_stock? %>
                    <% if @post.the_qty_real.to_i > 0 %>
                        <%= form_tag(plugins_ecommerce_checkout_cart_add_path, :method => "post", :class => "form") do %>
                            <% if @post.is_variation_product? %>
                                <div class="form-group">
                                    <%= label_tag :variation_id %>
                                    <select class="form-control required" name="variation_id" id="product_variation_id">
                                        <% @post.product_variations.each_with_index do |variation, index| %>
                                            <option data-sku="<%= variation.sku %>" <%= 'selected' if index == 0 %> <%= 'disabled' unless @post.in_stock?(variation.id) %> data-price="<%= @post.the_price(variation.id) %>" value="<%= variation.id %>"><%= @post.the_variation_title(variation.id) %></option>
                                        <% end %>
                                    </select>
                                </div>
                            <% end %>
                            <div class="input-group">
                                <span class="input-group-addon">Qty: </span>
                                <%= number_field :cart, :qty, class: 'form-control', value: 1, min: 0, max: @post.the_qty_real.to_i %>
                                <%= hidden_field :cart, :product_id, value: @post.id %>
                                <span class="input-group-btn"><button class="btn btn-default" type="submit"><i class="fa fa-shopping-cart"></i> Add to cart</button></span>
                            </div>
                        <% end %>
                    <% end %>
                <% end %>
                <hr>
                <div class="social-icons">
                    <ul>
                        <li><a class="facebook1" href="#"><i class="fa fa-facebook"></i></a></li>
                        <li><a class="twitter1" href="#"><i class="fa fa-twitter"></i></a></li>
                        <li><a class="googleplus1" href="#"><i class="fa fa-google-plus"></i></a></li>
                    </ul>
                </div>
                <div class="clearfix"></div>
                <% if @post.is_variation_product? %>
                    <script>
                        jQuery(function(){
                            var panel = $('#product_view');
                            panel.find('#product_variation_id').change(function(){ var op = $(this).find('option:selected'); panel.find('#product_sku').html(op.attr('data-sku')); panel.find('#product_price').html(op.attr('data-price'));  }).trigger('change');
                        });
                    </script>
                <% end %>
            </div>
        </div>
        <div class="clearfix"></div>
        <div class="reviews-tabs">
            <!-- Main component for a primary marketing message or call to action -->
            <ul class="nav nav-tabs responsive hidden-xs hidden-sm" id="myTab">
                <li class="test-class active"><a role="tab" data-toggle="tab" class="deco-none misc-class" href="#how-to"> More Information</a></li>
                <li class="test-class"><a role="tab" data-toggle="tab" href="#features">Specifications</a></li>
                <li class="test-class"><a role="tab" data-toggle="tab" class="deco-none" href="#product_comments">Reviews (<%= @post.the_comments.count %>)</a></li>
            </ul>

            <div class="tab-content responsive hidden-xs hidden-sm">
                <div class="tab-pane active" id="how-to">
                    <%= raw @post.the_content %>
                </div>
                <div class="tab-pane" id="features">
                    <%= raw @post.the_meta('product_specifications') %>
                </div>
                <div class="tab-pane" id="product_comments">
                    <div class="response">
                        <%= render partial: 'partials/comments', locals: {post: @post, style2: true} if @post.can_commented? %>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="clearfix"></div>
</div>